@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap');
@tailwind base;
@tailwind components;
@tailwind utilities;

:root{
  --color-paper: #F4F4F1;
  --color-ink: #1A1A1A;
  --color-safety: #FF5C00;
  --color-mint: #B3E5E1;
  --baseline: 8px;
}

/* global page frame */
html,body,#root{height:100%}
body{
  background:var(--color-paper);
  color:var(--color-ink);
  font-family: theme('fontFamily.ui');
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  line-height:1.4;
  -webkit-text-size-adjust:100%;
}

/* RSVP-specific tokens */
.rsvp-display{
  font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
  letter-spacing: 0;
  font-feature-settings: 'liga' 0;
  -webkit-font-smoothing:antialiased;
  position: relative;
  overflow: hidden;
}
.rsvp-viewport{position:relative;display:block;width:100%;height:84px;display:flex;align-items:center;justify-content:center}
.rsvp-word{display:inline-flex;white-space:nowrap;will-change:transform;transform:translateX(0);transition:none}
.rsvp-word *{transition: none !important}
.rsvp-pivot-line{position:absolute;top:50%;transform:translateY(-50%);width:2px;background:rgba(26,26,26,0.12);height:28px;border-radius:4px;pointer-events:none}
.rsvp-pivot-line.bottom{top:auto;bottom:50%;transform:translateY(50%)}
.rsvp-orp{color:var(--color-safety);font-weight:600}

/* Ghost trail for retinal persistence */
.rsvp-ghost{position:absolute;left:0;top:50%;transform-origin:left center;transform:translateY(-50%);color:var(--color-ink);opacity:0.05;pointer-events:none;filter:opacity(0.05);mix-blend-mode:normal;white-space:nowrap;animation:ghostFade 20ms linear forwards}
@keyframes ghostFade{from{opacity:0.05}to{opacity:0}}

/* ORP hyper-flow glow when WPM > 500 */
.rsvp-orp--hyper{animation:orpGlow 900ms infinite linear; filter:drop-shadow(0 0 6px rgba(255,92,0,0.18))}
@keyframes orpGlow{0%{text-shadow:0 0 0 rgba(255,92,0,0)}50%{text-shadow:0 0 6px rgba(255,92,0,0.28)}100%{text-shadow:0 0 0 rgba(255,92,0,0)}}

/* Thought bubble (empty/paused cadence) */
.rsvp-thought{position:absolute;left:35%;top:22%;transform:translateX(-50%);opacity:0.9;color:rgba(26,26,26,0.6);display:flex;align-items:center;justify-content:center;width:48px;height:36px;border-radius:18px;background:rgba(255,255,255,0.6);border:2px solid rgba(26,26,26,0.06);box-shadow:0 2px 0 rgba(0,0,0,0.04)}

/* reduced motion fallback */
.reduced-motion .rsvp-ghost{animation:none;opacity:0}
.reduced-motion .rsvp-word{transition:none !important}
.reduced-motion .rsvp-orp--hyper{animation:none;filter:none}


/* visible 8px baseline overlay (utility for the design system only) */
.grid-overlay{
  pointer-events:none;
  background-image: linear-gradient(rgba(26,26,26,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(26,26,26,0.02) 1px, transparent 1px);
  background-size: var(--baseline) var(--baseline), var(--baseline) var(--baseline);
}

/* subtle paper grain */
.app-shell::before{
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'><rect width='200' height='200' fill='%23F4F4F1' opacity='1'/><g fill='%23ffffff' opacity='0.02'><circle cx='10' cy='10' r='1'/><circle cx='30' cy='40' r='1'/><circle cx='60' cy='80' r='1'/></g></svg>");
  opacity: 1;
  mix-blend-mode: overlay;
}

/* allow rubber-band overscroll where desired */
.allow-rubber{ -webkit-overflow-scrolling: touch; overscroll-behavior: auto }

/* pivot nicks - ensure 2px vertical guides that span the text area */
.rsvp-pivot-line{position:absolute;top:8%;width:2px;background:rgba(26,26,26,0.12);height:84%;border-radius:4px;pointer-events:none;transform:translateX(-50%)}
.rsvp-pivot-line.bottom{display:none}

/* Bento grid layout */
.bento-grid{display:grid;grid-template-columns:repeat(6,1fr);grid-template-rows:auto;gap:16px;align-items:start}
.bento-card{box-sizing:border-box}
.bento-card-large{grid-column:span 4;min-height:220px}
.bento-card-med{grid-column:span 2;min-height:160px}
.bento-card-small{grid-column:span 2;min-height:96px}
.bento-card-small-grid{grid-column:span 2;min-height:96px}

/* Drop-zone immediate feedback (must show within one frame) */
.drop-zone{transition:box-shadow 200ms cubic-bezier(.2,.9,.2,1), transform 160ms cubic-bezier(.2,.9,.2,1)}
.drop-zone.drop-loading{box-shadow:0 6px 0 rgba(0,0,0,0.06);transform:translateY(1px);background:linear-gradient(180deg,rgba(255,92,0,0.03),transparent)}

/* screen-reader helper */
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

/* small accessibility token */
.reduced-motion *{
  transition: none !important;
  animation: none !important;
}

/* App shell safe-area padding */
.app-shell{
  padding-top: calc(var(--baseline) + env(safe-area-inset-top));
  padding-bottom: calc(var(--baseline) + env(safe-area-inset-bottom));
  padding-left: calc(var(--baseline) + env(safe-area-inset-left));
  padding-right: calc(var(--baseline) + env(safe-area-inset-right));
}

/* Flow reader styles */
.flow-paragraph{font-size:16px;line-height:28px;color:var(--color-ink);word-break:break-word}
.flow-word{cursor:text;transition:transform 160ms cubic-bezier(.2,.9,.2,1)}
.flow-word--active{transform:translateY(-2px)}
.flow-word--active::after{content:'';display:block;height:3px;background:linear-gradient(90deg,var(--color-safety),#FFB88A);border-radius:4px;margin-top:6px;opacity:0.95;will-change:transform,opacity}

/* active underline pulse (reduced-motion respectful) */
@media (prefers-reduced-motion: no-preference){
  .flow-word--active::after{animation:flow-pulse  calc(60ms * 6) ease-in-out infinite}
}
@keyframes flow-pulse{0%{transform:scaleX(0.9);opacity:0.9}50%{transform:scaleX(1.18);opacity:0.7}100%{transform:scaleX(0.9);opacity:0.9}}

/* disable pull-to-refresh in most browsers; Flow Mode will opt-in to custom refresh */
html,body,#root{
  overscroll-behavior-y: none;
}
